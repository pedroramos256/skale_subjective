<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Subjective</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">    </head>
    <body>
        <div class="container col-lg-9">
            <div class="row">
              
              <div id="loader">
                <br>
                <p class="text-center">Loading...</p>
              </div>
              <div id="content" style="display: none;">
                <div align="center">
                    <br>
                    <h1>Subjective</h1>
                    <br>
                    <form onSubmit="App.getContract(); return false;" role="form">
                        <div class="form-group col-lg-6">
                            <div class="input-group">
                                <input id="owner" class="form-control input-lg w-50" placeholder="Owner address"></input>
                                <input id="index" type="number" class="form-control input-lg w-25" placeholder="Index" min="0"></input>
                                <span class="input-group-btn">
                                <button type="submit" class="btn btn-primary btn-lg"  data-bs-toggle="collapse" data-bs-target="#Actions" aria-expanded="false">Search</button>
                                </span>
                            </div>
                        </div>
                    </form>
                </div>
                <br>
                <div align="center" id="Actions">
                  <form style='display: inline-block; padding: 0.5em' onSubmit="App.upfront(); return false;" role="form">
                      <div class="form-group">
                          <div class="input-group">
                              <button type="submit" class="btn btn-primary">Upfront</button>
                          </div>
                      </div>
                  </form>
                  <form style='display: inline-block; padding: 0.5em' onSubmit="App.evaluate(); return false;" role="form">
                      <div class="form-group">
                          <div class="input-group">
                              
                              <input id="evaluation" type="number" class="form-control" placeholder="0 to max evaluation" min="0"></input>
                              <div class="form-check" style="padding-right:0.5em;padding-top:0.5em;">
                                <input class="form-check-input eval_upfront" style="text-align: left;" name="eval_upfront" type="checkbox" id="eval_upfrontRadio">
                                <label class="form-check-label" for="thirdPartyRadio1">Pay upfront</label>
                              </div>
                              <span class="input-group-btn">
                                <button type="submit" class="btn btn-primary">Evaluate</button>
                              </span>
                          </div>
                          
                      </div>
                  </form>
                  <form style='display: inline-block; padding: 0.5em' onSubmit="App.withdraw(); return false;" role="form">
                      <div class="form-group">
                          <div class="input-group"> 
                              <button type="submit" class="btn btn-primary">Withdraw</button>
                          </div>
                      </div>
                  </form>
                  <br>
                  <br>
                  <table id="mytable" class="table table-bordered w-75" style="text-align: center;"></table>
                </div>
                <br>
                <div align="center">
                    <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                        Create Contract
                    </button>
                </div>
                <div class="collapse" id="collapseExample">
                    <br>
                    <form onSubmit="createContract(); return false;" role="form">
      
                        <div class="row g-3 align-items-center">
                            <div class="col-lg-2">
                              <label for="secondParty" class="col-form-label">Second party:</label>
                            </div>
                            <div class="col-lg-4">
                              <input id="secondParty" class="form-control" placeholder="Address">
                            </div>
                        </div>                        
                        <br>
                        <div class="row g-3 align-items-center">
                          <div class="col-lg-2">
                            <label for="isSeller" class="col-form-label">Role: </label>
                          </div>
                          <span class="col-lg-4">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input isSeller" type="radio" name="isSeller" id="inlineRadio1" value="true" checked>
                            <label class="form-check-label" for="inlineRadio1">Seller</label>
                          </div>
                          <div class="form-check form-check-inline">
                              <input class="form-check-input isSeller" type="radio" name="isSeller" id="inlineRadio2" value="false">
                              <label class="form-check-label" for="inlineRadio2">Buyer</label>
                          </div>
                          </span>
                        </div>
                        <br>
                        <div class="row g-3 align-items-center">
                            <div class="col-lg-2">
                              <label for="max_price" class="col-form-label">Maximum Price: </label>
                            </div>
                            <div class="col-lg-2">
                              <input type="number" id="max_price" class="form-control" placeholder="Finney" min="0">
                            </div>
                        </div>
                        <br>
                        <div class="row g-3 align-items-center">
                          <div class="col-lg-2">
                            <label for="max_evaluation" class="col-form-label">Maximum evaluation: </label>
                          </div>
                          <div class="col-lg-2">
                            <input type="number" id="max_evaluation" class="form-control" value="3">
                          </div>
                        </div>
                        <br>
                        <div>
                          <button class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
                            Advanced Options
                          </button>
                        </div>
                        <div class="collapse" id="collapse2">
                          <br>
                          <div class="row g-3 align-items-center">
                            <div class="col-lg-2">
                              <label for="thirdParty" class="col-form-label">Third party: </label>
                            </div>
                            <div class="col-lg-4">
                              <div class="form-check">
                                <input class="form-check-input thirdParty" name="thirdParty" type="radio" id="thirdPartyRadio1" value="0x0C62eD2E5BfB40F7600cD57489226b9471C9Db6f" checked>
                                <label class="form-check-label" for="thirdPartyRadio1">Subjective</label>
                              </div>
                              <div class="form-check">
                                <input class="form-check-input thirdParty" name="thirdParty" type="radio" id="thirdPartyRadio4" value="other">
                                <label class="form-check-label" for="thirdPartyRadio4">Other</label>
                              </div>
                              
                            </div>
                          </div>
                          <br>
                          <div class="row g-3 align-items-center">
                            <div class="col-lg-2">
                              <label for="min_price" class="col-form-label">Minimum price: </label>
                            </div>
                            <div class="col-lg-2">
                              <input type="number" id="min_price" class="form-control" value="0">
                            </div>
                          </div>
                          <br>
                          <div class="row g-3 align-items-center">
                              <div class="col-lg-2">
                                <label for="quotient" class="col-form-label">Quotient: </label>
                              </div>
                              <div class="col-lg-2">
                                <input type="number" id="quotient" class="form-control" value="10">
                              </div>
                          </div>
                          <br>
                          <div class="row g-3 align-items-center">
                              <div class="col-lg-2">
                                <label for="upfront_time" class="col-form-label">Days for upfront: </label>
                              </div>
                              <div class="col-lg-2">
                                <input type="number" id="upfront_time" class="form-control" value="7">
                              </div>
                          </div>
                          <br>
                          <div class="row g-3 align-items-center">
                              <div class="col-lg-2">
                                <label for="evaluation_time" class="col-form-label">Days for evaluation: </label>
                              </div>
                              <div class="col-lg-2">
                                <input type="number" id="evaluation_time" class="form-control" value="30">
                              </div>
                          </div>
                          <br>
                          <div class="row g-3 align-items-center">
                            <div class="col-lg-2">
                              <label for="payUpfront" class="col-form-label">Pay upfront now? </label>
                            </div>
                            <span class="col-lg-4">
                            <div class="form-check form-check-inline">
                              <input class="form-check-input payUpfront" type="radio" name="payUpfront" id="upfrontRadio1" value="true" checked>
                              <label class="form-check-label" for="upfrontRadio1">Yes</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input payUpfront" type="radio" name="payUpfront" id="upfrontRadio2" value="false">
                                <label class="form-check-label" for="upfrontRadio2">No</label>
                            </div> 
                            </span>
                          </div>
                          <br>
                          <div class="row g-3 align-items-center">
                            <div class="col-lg-2">
                              <label for="evaluation" class="col-form-label">Evaluate now? </label>
                            </div>
                            <span class="col-lg-4">
                              <div class="form-check form-check-inline">
                              <input class="form-check-input evaluation" type="radio" name="evaluation" id="evaluationRadio1" value="true">
                              <label class="form-check-label" for="evaluationRadio1">Yes</label>
                            </div>  
                            <div class="form-check form-check-inline">
                                <input class="form-check-input evaluation" type="radio" name="evaluation" id="evaluationRadio2" value="false" checked>
                                <label class="form-check-label" for="evaluationRadio2">No</label>
                            </div>
                            <input class='form-control evaluation w-50' name='evaluation' id='evaluation-input' type="number" value="1001"/><br>
                            </span>
                          </div>
                          <div id="table-preview-div"></div>
                        </div>
                        <br>
                        <button type="submit" class="btn btn-primary col-lg-1">Create</button>
                    </form>
                </div>
                <br>
                <br>
                <div class="accordion" id="FAQ">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        What is a subjective smart contract?
                      </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                      <div class="accordion-body">
                        <p>
                          A smart contract is an algorithm in a blockchain that act as an intermediary, enforcing an agreement between all the participants.
                          <br>
                          It is the underlying technology of <b>stable coins, NFTs, token swaps, and DAOs</b>.
                          <br><br>
                          An even more interesting application of smart contracts is with the connection with <b>real world events</b>.
                          <br>
                          The potential applications go from insurance services to supply chains, using IoT connected to the blockchain.
                          <br><br>
                          The problem arises when the real world event cannot be read by an IoT device, and or the information is <b>not public</b>, so only the parties involved know what happened. 
                          <br><br>
                          The goal of a <b>subjective</b> smart contract is to solve this use cases!                         
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        How to use it?
                      </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                      <div class="accordion-body">
                        Imagine you buy or sell a product or service. 
                        <br>
                        No one else knows if the product or service was delivered as expected, except for the buyer and seller.
                        <br><br>
                        Using game theory, we can encourage both parties to agree on what actually happened.
                        <br>
                        The buyer can evaluate the seller with 0 (bad product or service) or 1 (good).
                        <br>
                        The seller can auto-evaluate himself also with 0 or 1.
                        <br><br>
                        Buyer <b>1</b>, Seller <b>1</b>: Buyer pays <b>p</b> to the seller. 
                        <br><br>
                        Buyer <b>0</b>, Seller <b>0</b>: No one pays anything.
                        <br><br>
                        Buyer <b>0</b>, Seller <b>1</b>: Someone is lying.
                        <br>
                        Since the smart contract doesn't know who is lying:
                        <br> 
                        The buyer will pay <b>p</b> plus a penalty <b>q</b>. 
                        <br>
                        And the seller will pay also a penalty <b>q</b>.
                        <br><br>
                        Buyer <b>1</b>, Seller <b>0</b>: Well, both are being pretty modest here. 
                        <br>
                        This might happen if instead of the evaluation being between 0 and 1, if it a star rating between 0 and 3 or 5.
                        <br>
                        If the buyer evaluates the product or service with 5 stars and the seller auto-evaluates with 4, and the <b>p</b> is for example 5$, then the buyer will pay 4.5$. 
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        Contract parameters.
                      </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                      <div class="accordion-body">
                        <b>Second party</b>: The wallet address of the person with whom you are making a contract.
                        <br><br>
                        <b>Third party</b>: Well, if both get a penalty, the money you lost cannot go to a black hole, you can choose to whom that money should go.
                        <br><br>
                        <b>Role</b>: Are you the buyer or the seller of this contract?
                        <br><br>
                        <b>Max Price</b>: The price to be payed if both agree the product or service was perfect.
                        <br><br>
                        <b>Min Price</b>: The price to be payed if both agree the product was not satisfactory, it can even be a negative value, meaning the sellers needs to compensate the buyer for not delivering well.
                        <br><br>
                        <b>Quotient</b>: How many times smaller should be the penalty, compared with the maximum price.
                        <br><br>
                        <b>Max evaluation</b>: Is it a true false situation? Is it a star system between 0 and 3 or 5 stars? You choose.
                        <br><br>
                        <b>Days for upfront</b>: How many days do each party have to pay an upfront value?
                        <br><br>
                        <b>Days for evaluation</b>: How many days do each party have to evaluate the product or service?
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFour">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        White paper and source code.
                      </button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                      <div class="accordion-body">
                      </div>
                    </div>
                  </div>
                </div>
                <br>
              </div>
            </div>
        </div>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@truffle/contract@latest/dist/truffle-contract.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/js/bootstrap.min.js"></script>
        <!--
        <script src="js/jquery.min.js"></script>
        <script src="js/web3.min.js"></script>
        <script src="js/truffle-contract.js"></script>
        <script src="js/bootstrap.min.js"></script>
        -->
        <script src="https://unpkg.com/@metamask/detect-provider/dist/detect-provider.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
        <script src="js/app.js"></script>
    </body>
</html>
